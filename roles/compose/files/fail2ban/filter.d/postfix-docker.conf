# Fail2Ban filter for postfix running in Docker containers
# This filter handles the nested log format where Docker logs contain
# both the container timestamp and the inner postfix timestamp

[INCLUDES]
before = common.conf

[Definition]

# Match the full Docker postfix log format directly
# Format: Aug 19 16:15:00 green postfix[621]: Aug 19 14:15:00 smtp postfix/smtpd[140230]: warning: hostname[IP]: SASL LOGIN authentication failed
failregex = .*\[<HOST>\].*SASL.*authentication failed

# Ignore successful authentications
ignoreregex = .*SASL.*authentication successful
